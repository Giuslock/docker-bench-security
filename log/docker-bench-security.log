Initializing 2021-06-21T11:48:39+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1  - Ensure that a user for the container has been created (Scored)
[1;31m[WARN][0m      * Running as root: interesting_cannon
[1;31m[WARN][0m      * Running as root: practical_buck
[1;31m[WARN][0m      * Running as root: sad_edison
[1;33m[NOTE][0m 4.2  - Ensure that containers use only trusted base images (Not Scored)
[1;33m[NOTE][0m 4.3  - Ensure that unnecessary packages are not installed in the container (Not Scored)
[1;33m[NOTE][0m 4.4  - Ensure images are scanned and rebuilt to include security patches (Not Scored)
[1;31m[WARN][0m 4.5  - Ensure Content trust for Docker is Enabled (Scored)
[1;31m[WARN][0m 4.6  - Ensure that HEALTHCHECK instructions have been added to container images (Scored)
[1;31m[WARN][0m      * No Healthcheck found: [ubuntu:latest]
[1;31m[WARN][0m      * No Healthcheck found: [alpine:latest]
[1;31m[WARN][0m      * No Healthcheck found: [nginx:latest]
[1;32m[PASS][0m 4.7  - Ensure update instructions are not used alone in the Dockerfile (Not Scored)
[1;33m[NOTE][0m 4.8  - Ensure setuid and setgid permissions are removed (Not Scored)
[1;32m[PASS][0m 4.9  - Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.10  - Ensure secrets are not stored in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.11  - Ensure only verified packages are are installed (Not Scored)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: interesting_cannon
[1;31m[WARN][0m      * No SecurityOptions Found: practical_buck
[1;31m[WARN][0m      * No SecurityOptions Found: sad_edison
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: interesting_cannon
[1;31m[WARN][0m       * Container running without memory restrictions: practical_buck
[1;31m[WARN][0m       * Container running without memory restrictions: sad_edison
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: interesting_cannon
[1;31m[WARN][0m       * Container running without CPU restrictions: practical_buck
[1;31m[WARN][0m       * Container running without CPU restrictions: sad_edison
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: interesting_cannon
[1;31m[WARN][0m       * Container running with root FS mounted R/W: practical_buck
[1;31m[WARN][0m       * Container running with root FS mounted R/W: sad_edison
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: interesting_cannon
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: practical_buck
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: sad_edison
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: interesting_cannon
[1;34m[INFO][0m       * Container no default ulimit override: practical_buck
[1;34m[INFO][0m       * Container no default ulimit override: sad_edison
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: interesting_cannon
[1;31m[WARN][0m       * Privileges not restricted: practical_buck
[1;31m[WARN][0m       * Privileges not restricted: sad_edison
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: interesting_cannon
[1;31m[WARN][0m       * Health check not set: practical_buck
[1;31m[WARN][0m       * Health check not set: sad_edison
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: interesting_cannon
[1;31m[WARN][0m       * PIDs limit not set: practical_buck
[1;31m[WARN][0m       * PIDs limit not set: sad_edison
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: sad_edison
[1;34m[INFO][0m       * Container in docker0 network: interesting_cannon
[1;34m[INFO][0m       * Container in docker0 network: practical_buck
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1  - Ensure that image sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2  - Ensure that container sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently a total of 18 containers, with 3 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1  - Ensure swarm mode is not Enabled, if not needed (Scored)
[1;32m[PASS][0m 7.2  - Ensure that the minimum number of manager nodes have been created in a swarm (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3  - Ensure that swarm services are bound to a specific host interface (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.4  - Ensure that all Docker swarm overlay networks are encrypted (Scored)
[1;32m[PASS][0m 7.5  - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6  - Ensure that swarm manager is run in auto-lock mode (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7  - Ensure that the swarm manager auto-lock key is rotated periodically (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8  - Ensure that node certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9  - Ensure that CA certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.10  - Ensure that management plane traffic is separated from data plane traffic (Not Scored) (Swarm mode not enabled)

[1;34m[INFO][0m 8 - Docker Enterprise Configuration
[1;34m[INFO][0m   * Community Engine license, skipping section 8


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.5 - Add DOCKER_CONTENT_TRUST variable to the /etc/environment file using command echo DOCKER_CONTENT_TRUST=1 | sudo tee -a /etc/environment. Remediation Impact: This prevents users from working with tagged images unless they contain a signature.
[1;34m[INFO][0m 4.6 - You should follow the Docker documentation and rebuild your container images to include the HEALTHCHECK instruction. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - You should keep only the images that you actually need and establish a workflow to remove old or stale images from the host. Additionally, you should use features such as pull-by-digest to get specific images from the registry. Remediation Impact: docker system prune -a removes all exited containers as well as all images and volumes that are not referenced by running containers, including for UCP and DTR.
[1;34m[INFO][0m 6.2 - You should periodically check your container inventory on each host and clean up containers which are not in active use with the command: docker container prune Remediation Impact: You should retain containers that are actively in use, and delete ones which are no longer needed.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 54
[1;34m[INFO][0m Score: 10

Initializing 2021-06-21T12:41:28+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1  - Ensure that a user for the container has been created (Scored)
[1;31m[WARN][0m      * Running as root: intelligent_blackburn
[1;33m[NOTE][0m 4.2  - Ensure that containers use only trusted base images (Not Scored)
[1;33m[NOTE][0m 4.3  - Ensure that unnecessary packages are not installed in the container (Not Scored)
[1;33m[NOTE][0m 4.4  - Ensure images are scanned and rebuilt to include security patches (Not Scored)
[1;31m[WARN][0m 4.5  - Ensure Content trust for Docker is Enabled (Scored)
[1;31m[WARN][0m 4.6  - Ensure that HEALTHCHECK instructions have been added to container images (Scored)
[1;31m[WARN][0m      * No Healthcheck found: [ubuntu:latest]
[1;31m[WARN][0m      * No Healthcheck found: [alpine:latest]
[1;31m[WARN][0m      * No Healthcheck found: [nginx:latest]
[1;32m[PASS][0m 4.7  - Ensure update instructions are not used alone in the Dockerfile (Not Scored)
[1;33m[NOTE][0m 4.8  - Ensure setuid and setgid permissions are removed (Not Scored)
[1;32m[PASS][0m 4.9  - Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.10  - Ensure secrets are not stored in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.11  - Ensure only verified packages are are installed (Not Scored)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: intelligent_blackburn
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: intelligent_blackburn
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: intelligent_blackburn
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: intelligent_blackburn
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: intelligent_blackburn
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: intelligent_blackburn
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: intelligent_blackburn
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: intelligent_blackburn
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: intelligent_blackburn
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: intelligent_blackburn
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1  - Ensure that image sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2  - Ensure that container sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently a total of 19 containers, with 1 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1  - Ensure swarm mode is not Enabled, if not needed (Scored)
[1;32m[PASS][0m 7.2  - Ensure that the minimum number of manager nodes have been created in a swarm (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3  - Ensure that swarm services are bound to a specific host interface (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.4  - Ensure that all Docker swarm overlay networks are encrypted (Scored)
[1;32m[PASS][0m 7.5  - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6  - Ensure that swarm manager is run in auto-lock mode (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7  - Ensure that the swarm manager auto-lock key is rotated periodically (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8  - Ensure that node certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9  - Ensure that CA certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.10  - Ensure that management plane traffic is separated from data plane traffic (Not Scored) (Swarm mode not enabled)

[1;34m[INFO][0m 8 - Docker Enterprise Configuration
[1;34m[INFO][0m   * Community Engine license, skipping section 8


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.5 - Add DOCKER_CONTENT_TRUST variable to the /etc/environment file using command echo DOCKER_CONTENT_TRUST=1 | sudo tee -a /etc/environment. Remediation Impact: This prevents users from working with tagged images unless they contain a signature.
[1;34m[INFO][0m 4.6 - You should follow the Docker documentation and rebuild your container images to include the HEALTHCHECK instruction. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - You should keep only the images that you actually need and establish a workflow to remove old or stale images from the host. Additionally, you should use features such as pull-by-digest to get specific images from the registry. Remediation Impact: docker system prune -a removes all exited containers as well as all images and volumes that are not referenced by running containers, including for UCP and DTR.
[1;34m[INFO][0m 6.2 - You should periodically check your container inventory on each host and clean up containers which are not in active use with the command: docker container prune Remediation Impact: You should retain containers that are actively in use, and delete ones which are no longer needed.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 54
[1;34m[INFO][0m Score: 10

Initializing 2021-06-21T13:22:51+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1  - Ensure that a user for the container has been created (Scored)
[1;31m[WARN][0m      * Running as root: intelligent_blackburn
[1;33m[NOTE][0m 4.2  - Ensure that containers use only trusted base images (Not Scored)
[1;33m[NOTE][0m 4.3  - Ensure that unnecessary packages are not installed in the container (Not Scored)
[1;33m[NOTE][0m 4.4  - Ensure images are scanned and rebuilt to include security patches (Not Scored)
[1;31m[WARN][0m 4.5  - Ensure Content trust for Docker is Enabled (Scored)
[1;31m[WARN][0m 4.6  - Ensure that HEALTHCHECK instructions have been added to container images (Scored)
[1;31m[WARN][0m      * No Healthcheck found: [ubuntu:latest]
[1;31m[WARN][0m      * No Healthcheck found: [alpine:latest]
[1;31m[WARN][0m      * No Healthcheck found: [nginx:latest]
[1;32m[PASS][0m 4.7  - Ensure update instructions are not used alone in the Dockerfile (Not Scored)
[1;33m[NOTE][0m 4.8  - Ensure setuid and setgid permissions are removed (Not Scored)
[1;32m[PASS][0m 4.9  - Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.10  - Ensure secrets are not stored in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.11  - Ensure only verified packages are are installed (Not Scored)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: intelligent_blackburn
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: intelligent_blackburn
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: intelligent_blackburn
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: intelligent_blackburn
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: intelligent_blackburn
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: intelligent_blackburn
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: intelligent_blackburn
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: intelligent_blackburn
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: intelligent_blackburn
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: intelligent_blackburn
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1  - Ensure that image sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently: 4 images
[1;34m[INFO][0m 6.2  - Ensure that container sprawl is avoided (Not Scored)
[1;34m[INFO][0m      * There are currently a total of 19 containers, with 1 of them currently running

[1;34m[INFO][0m 7 - Docker Swarm Configuration
[1;32m[PASS][0m 7.1  - Ensure swarm mode is not Enabled, if not needed (Scored)
[1;32m[PASS][0m 7.2  - Ensure that the minimum number of manager nodes have been created in a swarm (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.3  - Ensure that swarm services are bound to a specific host interface (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.4  - Ensure that all Docker swarm overlay networks are encrypted (Scored)
[1;32m[PASS][0m 7.5  - Ensure that Docker's secret management commands are used for managing secrets in a swarm cluster (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.6  - Ensure that swarm manager is run in auto-lock mode (Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.7  - Ensure that the swarm manager auto-lock key is rotated periodically (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.8  - Ensure that node certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.9  - Ensure that CA certificates are rotated as appropriate (Not Scored) (Swarm mode not enabled)
[1;32m[PASS][0m 7.10  - Ensure that management plane traffic is separated from data plane traffic (Not Scored) (Swarm mode not enabled)

[1;34m[INFO][0m 8 - Docker Enterprise Configuration
[1;34m[INFO][0m   * Community Engine license, skipping section 8


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.5 - Add DOCKER_CONTENT_TRUST variable to the /etc/environment file using command echo DOCKER_CONTENT_TRUST=1 | sudo tee -a /etc/environment. Remediation Impact: This prevents users from working with tagged images unless they contain a signature.
[1;34m[INFO][0m 4.6 - You should follow the Docker documentation and rebuild your container images to include the HEALTHCHECK instruction. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.

[1;34m[INFO][0m 6 - Docker Security Operations
[1;34m[INFO][0m 6.1 - You should keep only the images that you actually need and establish a workflow to remove old or stale images from the host. Additionally, you should use features such as pull-by-digest to get specific images from the registry. Remediation Impact: docker system prune -a removes all exited containers as well as all images and volumes that are not referenced by running containers, including for UCP and DTR.
[1;34m[INFO][0m 6.2 - You should periodically check your container inventory on each host and clean up containers which are not in active use with the command: docker container prune Remediation Impact: You should retain containers that are actively in use, and delete ones which are no longer needed.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 54
[1;34m[INFO][0m Score: 10

Initializing 2021-06-21T16:16:31+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: strange_nightingale
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: strange_nightingale
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: strange_nightingale
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: strange_nightingale
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: strange_nightingale
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: strange_nightingale
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: strange_nightingale
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: strange_nightingale
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: strange_nightingale
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: strange_nightingale
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 31
[1;34m[INFO][0m Score: 8

Initializing 2021-06-21T16:20:39+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: strange_saha
[1;31m[WARN][0m      * No SecurityOptions Found: strange_nightingale
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: strange_saha
[1;31m[WARN][0m       * Container running without memory restrictions: strange_nightingale
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: strange_saha
[1;31m[WARN][0m       * Container running without CPU restrictions: strange_nightingale
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: strange_saha
[1;31m[WARN][0m       * Container running with root FS mounted R/W: strange_nightingale
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: strange_saha
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: strange_nightingale
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: strange_saha
[1;34m[INFO][0m       * Container no default ulimit override: strange_nightingale
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: strange_saha
[1;31m[WARN][0m       * Privileges not restricted: strange_nightingale
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: strange_saha
[1;31m[WARN][0m       * Health check not set: strange_nightingale
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: strange_saha
[1;31m[WARN][0m       * PIDs limit not set: strange_nightingale
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: strange_saha
[1;34m[INFO][0m       * Container in docker0 network: strange_nightingale
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 31
[1;34m[INFO][0m Score: 8

Initializing 2021-06-21T16:22:31+02:00


[1;33mSection A - Check results


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 0
[1;34m[INFO][0m Score: 0

Initializing 2021-06-21T16:26:54+02:00


[1;33mSection A - Check results

[1;34m[INFO][0m 4 - Container Images and Build File
[1;31m[WARN][0m 4.1  - Ensure that a user for the container has been created (Scored)
[1;31m[WARN][0m      * Running as root: strange_saha
[1;31m[WARN][0m      * Running as root: strange_nightingale
[1;33m[NOTE][0m 4.2  - Ensure that containers use only trusted base images (Not Scored)
[1;33m[NOTE][0m 4.3  - Ensure that unnecessary packages are not installed in the container (Not Scored)
[1;33m[NOTE][0m 4.4  - Ensure images are scanned and rebuilt to include security patches (Not Scored)
[1;31m[WARN][0m 4.5  - Ensure Content trust for Docker is Enabled (Scored)
[1;31m[WARN][0m 4.6  - Ensure that HEALTHCHECK instructions have been added to container images (Scored)
[1;31m[WARN][0m      * No Healthcheck found: [ubuntu:latest]
[1;31m[WARN][0m      * No Healthcheck found: [alpine:latest]
[1;31m[WARN][0m      * No Healthcheck found: [nginx:latest]
[1;32m[PASS][0m 4.7  - Ensure update instructions are not used alone in the Dockerfile (Not Scored)
[1;33m[NOTE][0m 4.8  - Ensure setuid and setgid permissions are removed (Not Scored)
[1;32m[PASS][0m 4.9  - Ensure that COPY is used instead of ADD in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.10  - Ensure secrets are not stored in Dockerfiles (Not Scored)
[1;33m[NOTE][0m 4.11  - Ensure only verified packages are are installed (Not Scored)

[1;34m[INFO][0m 5 - Container Runtime
[1;32m[PASS][0m 5.1  - Ensure that, if applicable, an AppArmor Profile is enabled (Scored)
[1;31m[WARN][0m 5.2  - Ensure that, if applicable, SELinux security options are set (Scored)
[1;31m[WARN][0m      * No SecurityOptions Found: strange_saha
[1;31m[WARN][0m      * No SecurityOptions Found: strange_nightingale
[1;32m[PASS][0m 5.3  - Ensure that Linux kernel capabilities are restricted within containers (Scored)
[1;32m[PASS][0m 5.4  - Ensure that privileged containers are not used (Scored)
[1;32m[PASS][0m 5.5  - Ensure sensitive host system directories are not mounted on containers (Scored)
[1;32m[PASS][0m 5.6  - Ensure sshd is not run within containers (Scored)
[1;32m[PASS][0m 5.7  - Ensure privileged ports are not mapped within containers (Scored)
[1;33m[NOTE][0m 5.8  - Ensure that only needed ports are open on the container (Not Scored)
[1;32m[PASS][0m 5.9  - Ensure that the host's network namespace is not shared (Scored)
[1;31m[WARN][0m 5.10  - Ensure that the memory usage for containers is limited (Scored)
[1;31m[WARN][0m       * Container running without memory restrictions: strange_saha
[1;31m[WARN][0m       * Container running without memory restrictions: strange_nightingale
[1;31m[WARN][0m 5.11  - Ensure that CPU priority is set appropriately on containers (Scored)
[1;31m[WARN][0m       * Container running without CPU restrictions: strange_saha
[1;31m[WARN][0m       * Container running without CPU restrictions: strange_nightingale
[1;31m[WARN][0m 5.12  - Ensure that the container's root filesystem is mounted as read only (Scored)
[1;31m[WARN][0m       * Container running with root FS mounted R/W: strange_saha
[1;31m[WARN][0m       * Container running with root FS mounted R/W: strange_nightingale
[1;32m[PASS][0m 5.13  - Ensure that incoming container traffic is bound to a specific host interface (Scored)
[1;31m[WARN][0m 5.14  - Ensure that the 'on-failure' container restart policy is set to '5' (Scored)
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: strange_saha
[1;31m[WARN][0m       * MaximumRetryCount is not set to 5: strange_nightingale
[1;32m[PASS][0m 5.15  - Ensure that the host's process namespace is not shared (Scored)
[1;32m[PASS][0m 5.16  - Ensure that the host's IPC namespace is not shared (Scored)
[1;32m[PASS][0m 5.17  - Ensure that host devices are not directly exposed to containers (Not Scored)
[1;34m[INFO][0m 5.18  - Ensure that the default ulimit is overwritten at runtime if needed (Not Scored)
[1;34m[INFO][0m       * Container no default ulimit override: strange_saha
[1;34m[INFO][0m       * Container no default ulimit override: strange_nightingale
[1;32m[PASS][0m 5.19  - Ensure mount propagation mode is not set to shared (Scored)
[1;32m[PASS][0m 5.20  - Ensure that the host's UTS namespace is not shared (Scored)
[1;32m[PASS][0m 5.21  - Ensurethe default seccomp profile is not Disabled (Scored)
[1;33m[NOTE][0m 5.22  - Ensure that docker exec commands are not used with the privileged option (Scored)
[1;33m[NOTE][0m 5.23  - Ensure that docker exec commands are not used with the user=root option (Not Scored)
[1;32m[PASS][0m 5.24  - Ensure that cgroup usage is confirmed (Scored)
[1;31m[WARN][0m 5.25  - Ensure that the container is restricted from acquiring additional privileges (Scored)
[1;31m[WARN][0m       * Privileges not restricted: strange_saha
[1;31m[WARN][0m       * Privileges not restricted: strange_nightingale
[1;31m[WARN][0m 5.26  - Ensure that container health is checked at runtime (Scored)
[1;31m[WARN][0m       * Health check not set: strange_saha
[1;31m[WARN][0m       * Health check not set: strange_nightingale
[1;34m[INFO][0m 5.27  - Ensure that Docker commands always make use of the latest version of their image (Not Scored)
[1;31m[WARN][0m 5.28  - Ensure that the PIDs cgroup limit is used (Scored)
[1;31m[WARN][0m       * PIDs limit not set: strange_saha
[1;31m[WARN][0m       * PIDs limit not set: strange_nightingale
[1;34m[INFO][0m 5.29  - Ensure that Docker's default bridge docker0 is not used (Not Scored)
[1;34m[INFO][0m       * Container in docker0 network: strange_saha
[1;34m[INFO][0m       * Container in docker0 network: strange_nightingale
[1;32m[PASS][0m 5.30  - Ensure that the host's user namespaces are not shared (Scored)
[1;32m[PASS][0m 5.31  - Ensure that the Docker socket is not mounted inside any containers (Scored)


[1;33mSection B - Remediation measures[0m

[1;34m[INFO][0m 4 - Container Images and Build File
[1;34m[INFO][0m 4.1 - You should ensure that the Dockerfile for each container image contains the information: USER <username or ID>. If there is no specific user created in the container base image, then make use of the useradd command to add a specific user before the USER instruction in the Dockerfile. Remediation Impact: Running as a non-root user can present challenges where you wish to bind mount volumes from the underlying host. In this case, care should be taken to ensure that the user running the contained process can read and write to the bound directory, according to their requirements.
[1;34m[INFO][0m 4.2 - Configure and use Docker Content trust. View the history of each Docker image to evaluate its risk, dependent on the sensitivity of the application you wish to deploy using it. Scan Docker images for vulnerabilities at regular intervals. Remediation Impact: None.
[1;34m[INFO][0m 4.3 - You should not install anything within the container that is not required. You should consider using a minimal base image if you can. Some of the options available include BusyBox and Alpine. Not only can this trim your image size considerably, but there would also be fewer pieces of software which could contain vectors for attack. Remediation Impact: None.
[1;34m[INFO][0m 4.4 - Images should be re-built ensuring that the latest version of the base images are used, to keep the operating system patch level at an appropriate level. Once the images have been re-built, containers should be re-started making use of the updated images. Remediation Impact: None.
[1;34m[INFO][0m 4.5 - Add DOCKER_CONTENT_TRUST variable to the /etc/environment file using command echo DOCKER_CONTENT_TRUST=1 | sudo tee -a /etc/environment. Remediation Impact: This prevents users from working with tagged images unless they contain a signature.
[1;34m[INFO][0m 4.6 - You should follow the Docker documentation and rebuild your container images to include the HEALTHCHECK instruction. Remediation Impact: None.
[1;34m[INFO][0m 4.8 - You should allow setuid and setgid permissions only on executables which require them. You could remove these permissions at build time by adding the following command in your Dockerfile, preferably towards the end of the Dockerfile: RUN find / -perm /6000 -type f -exec chmod a-s {} ; || true Remediation Impact: The above command would break all executables that depend on setuid or setgid permissions including legitimate ones. You should therefore be careful to modify the command to suit your requirements so that it does not reduce the permissions of legitimate programs excessively. Because of this, you should exercise a degree of caution and examine all processes carefully before making this type of modification in order to avoid outages.
[1;34m[INFO][0m 4.10 - Do not store any kind of secrets within Dockerfiles. Where secrets are required during the build process, make use of a secrets management tool, such as the buildkit builder included with Docker. Remediation Impact: A proper secrets management process will be required for Docker image building.
[1;34m[INFO][0m 4.11 - You should use a secure package distribution mechanism of your choice to ensure the authenticity of software packages. Remediation Impact: None.

[1;34m[INFO][0m 5 - Container Runtime
[1;34m[INFO][0m 5.2 - Set the SELinux State. Set the SELinux Policy. Create or import a SELinux policy template for Docker containers. Start Docker in daemon mode with SELinux enabled. Start your Docker container using the security options. Remediation Impact: Any restrictions defined in the SELinux policy will be applied to your containers. It should be noted that if your SELinux policy is misconfigured, this may have an impact on the correct operation of the affected containers.
[1;34m[INFO][0m 5.8 - You should ensure that the Dockerfile for each container image only exposes needed ports. Remediation Impact: None.
[1;34m[INFO][0m 5.10 - You should run the container with only as much memory as it requires by using the --memory argument. Remediation Impact: If correct memory limits are not set on each container, one process can expand its usage and cause other containers to run out of resources.
[1;34m[INFO][0m 5.11 - You should manage the CPU runtime between your containers dependent on their priority within your organization. To do so start the container using the --cpu-shares argument. Remediation Impact: If you do not correctly assign CPU thresholds, the container process may run out of resources and become unresponsive. If CPU resources on the host are not constrainted, CPU shares do not place any restrictions on individual resources.
[1;34m[INFO][0m 5.12 - You should add a --read-only flag at a container's runtime to enforce the container's root filesystem being mounted as read only. Remediation Impact: Enabling --read-only at container runtime may break some container OS packages if a data writing strategy is not defined. You should define what the container's data should and should not persist at runtime in order to decide which strategy to use.
[1;34m[INFO][0m 5.14 - If you wish a container to be automatically restarted, a sample command is docker run --detach --restart=on-failure:5 nginx Remediation Impact: If this option is set, a container will only attempt to restart itself 5 times.
[1;34m[INFO][0m 5.18 - You should only override the default ulimit settings if needed in a specific case. Remediation Impact: If ulimits are not set correctly, overutilization by individual containers could make the host system unusable.
[1;34m[INFO][0m 5.22 - You should not use the --privileged option in docker exec commands. Remediation Impact: If you need enhanced capabilities within a container, then run it with all the permissions it requires. These should be specified individually.
[1;34m[INFO][0m 5.23 - You should not use the --user=root option in docker exec commands. Remediation Impact: None.
[1;34m[INFO][0m 5.25 - You should start your container with the options: docker run --rm -it --security-opt=no-new-privileges ubuntu bash Remediation Impact: The no_new_priv option prevents LSMs like SELinux from allowing processes to acquire new privileges.
[1;34m[INFO][0m 5.26 - You should run the container using the --health-cmd parameter. Remediation Impact: None.
[1;34m[INFO][0m 5.27 - You should use proper version pinning mechanisms (the <latest> tag which is assigned by default is still vulnerable to caching attacks) to avoid extracting cached older versions. Version pinning mechanisms should be used for base images, packages, and entire images. You can customize version pinning rules according to your requirements. Remediation Impact: None.
[1;34m[INFO][0m 5.28 - Use --pids-limit flag with an appropriate value when launching the container. Remediation Impact: Set the PIDs limit value as appropriate. Incorrect values might leave containers unusable.
[1;34m[INFO][0m 5.29 - You should follow the Docker documentation and set up a user-defined network. All the containers should be run in this network. Remediation Impact: User-defined networks need to be configured and managed in line with organizational security policy.


[1;33mSection C - Score[0m

[1;34m[INFO][0m Checks: 42
[1;34m[INFO][0m Score: 5

